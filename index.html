<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CXI Pulse — Interview Wrap-up</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    />
    <link rel="stylesheet" href="./css/main.css" />
  </head>
  <body>
    <a class="skip-link" href="#pulse-form">Skip to post-interview pulse</a>
    <main class="layout">
      <section class="interview" aria-label="Live interview room">
        <header class="interview__topbar">
          <div class="badge" aria-live="polite">Live · Final Round</div>
          <div class="clock" id="session-clock" aria-hidden="true">03:28 remaining</div>
        </header>
        <div class="interview__grid">
          <article class="participant participant--lead">
            <span class="participant__label">Hiring Manager</span>
            <span class="participant__name">Jordan (Acme)</span>
          </article>
          <article class="participant participant--candidate">
            <span class="participant__label">Candidate</span>
            <span class="participant__name">[candidate]</span>
          </article>
          <article class="participant participant--observer">
            <span class="participant__label">Observer</span>
            <span class="participant__name">Priya · CXI</span>
          </article>
          <aside class="interview__note" aria-live="polite">
            "Wrap with the offer preview and confirm next-step ownership."
          </aside>
        </div>
        <footer class="interview__toolbar">
          <button type="button" class="toolbar-btn" data-action="mute">Mute</button>
          <button type="button" class="toolbar-btn" data-action="camera">Stop video</button>
          <div class="toolbar-spacer" aria-hidden="true"></div>
          <button
            type="button"
            class="toolbar-btn toolbar-btn--leave"
            id="leave-button"
            aria-haspopup="dialog"
          >
            Leave
          </button>
        </footer>
        <p class="interview__hint" id="intercept-hint" hidden>
          Pulse armed — Shift+D toggles demo mode.
        </p>
      </section>

      <section class="results" id="results-view" aria-live="polite" hidden>
        <header class="results__header">
          <h1>Pulse snapshot ready</h1>
          <p>
            Composite scores mirror the 48-hour SLA feed. Coaching prompts reuse the same
            snapshot so leaders, ops, and exports stay in lockstep.
          </p>
        </header>
        <div class="results__grid">
          <article class="results-card results-card--primary">
            <h2>Composite</h2>
            <p class="results-card__metric" id="composite-score">--</p>
            <p class="results-card__subtitle">Weighted sentiment × attention hygiene</p>
            <p class="results-card__status" id="composite-band">Pending…</p>
          </article>
          <article class="results-card">
            <h2>Net Support Signal</h2>
            <p class="results-card__metric" id="nss-score">--</p>
            <p class="results-card__subtitle">Scale −1 to +1, tuned for post-stage pulse</p>
            <p class="results-card__status">Index <span id="index-score">--</span></p>
          </article>
          <article class="results-card">
            <h2>Eligibility</h2>
            <dl class="results-card__list">
              <div>
                <dt>Incentive ready</dt>
                <dd id="eligibility-flag">pending</dd>
              </div>
              <div>
                <dt>Attention check</dt>
                <dd id="attention-status">pending</dd>
              </div>
              <div>
                <dt>Summary length</dt>
                <dd id="summary-length">pending</dd>
              </div>
            </dl>
          </article>
        </div>
        <div class="results__panels">
          <article class="panel" id="aspect-panel" data-state="pending">
            <header>
              <h2>Aspect pulse — Final round</h2>
              <p class="panel__note">Communication · Fairness · Feedback Timeliness · Conduct · Clarity · Scheduling · Respect</p>
            </header>
            <div class="panel__body">
              <ul class="chip-list" id="aspect-chips"></ul>
            </div>
          </article>
          <article class="panel" id="heatmap-panel" data-state="pending">
            <header>
              <h2>Leader heatmap (48h SLA)</h2>
              <p class="panel__note">Coaching prompts reuse this snapshot to avoid duplicate narratives.</p>
            </header>
            <div class="panel__body">
              <table class="heatmap" aria-describedby="heatmap-caption">
                <caption id="heatmap-caption">Stages × sentiment banding</caption>
                <thead>
                  <tr>
                    <th scope="col">Stage</th>
                    <th scope="col">Support index</th>
                    <th scope="col">SLA status</th>
                  </tr>
                </thead>
                <tbody id="heatmap-rows"></tbody>
              </table>
            </div>
          </article>
          <article class="panel" id="export-panel" data-state="pending">
            <header>
              <h2>Export preview</h2>
              <p class="panel__note">Same payload delivered to Ops + BI feeds.</p>
            </header>
            <div class="panel__body">
              <pre id="export-preview" class="export-preview">Loading…</pre>
            </div>
          </article>
        </div>
      </section>
    </main>

    <div class="pulse" id="pulse-overlay" hidden>
      <div class="pulse__dialog" role="dialog" aria-modal="true" aria-labelledby="pulse-title">
        <button type="button" class="pulse__close" id="pulse-close" aria-label="Dismiss pulse">×</button>
        <header class="pulse__header">
          <p class="pulse__eyebrow">Post-stage micro pulse</p>
          <h2 id="pulse-title">90-second pulse before you head out</h2>
          <p class="pulse__intro">
            One went-well, one could-be-better. Summaries feed the interview health dashboard within 48 hours.
          </p>
        </header>
        <form id="pulse-form" class="pulse__form">
          <section class="pulse__section">
            <label class="pulse__label" for="summary-input">
              Headline for leadership <span class="muted">(90–120 characters)</span>
            </label>
            <div class="input-counter" data-kind="characters">
              <textarea
                id="summary-input"
                name="summary"
                required
                minlength="90"
                maxlength="120"
                aria-describedby="summary-counter"
              ></textarea>
              <span id="summary-counter" class="counter" aria-live="polite">0 / 90–120</span>
            </div>
            <p class="sentiment-chip" data-target="summary">Neutral</p>
          </section>

          <section class="pulse__section">
            <label class="pulse__label" for="well-input">
              What went well? <span class="muted">(15+ words)</span>
            </label>
            <div class="input-counter" data-kind="words">
              <textarea
                id="well-input"
                name="wentWell"
                required
                data-min-words="15"
                aria-describedby="well-counter"
              ></textarea>
              <span id="well-counter" class="counter" aria-live="polite">0 words</span>
            </div>
            <p class="sentiment-chip" data-target="went-well">Neutral</p>
          </section>

          <section class="pulse__section">
            <label class="pulse__label" for="better-input">
              What could be better? <span class="muted">(15+ words)</span>
            </label>
            <div class="input-counter" data-kind="words">
              <textarea
                id="better-input"
                name="couldBeBetter"
                required
                data-min-words="15"
                aria-describedby="better-counter"
              ></textarea>
              <span id="better-counter" class="counter" aria-live="polite">0 words</span>
            </div>
            <p class="sentiment-chip" data-target="could-be-better">Neutral</p>
          </section>

          <section class="pulse__section">
            <fieldset class="pulse__fieldset" id="aspect-fieldset">
              <legend>Which aspects were most present?</legend>
              <p class="muted">Choose all that apply — these seed the ABSA model.</p>
              <div class="aspect-grid" id="aspect-grid"></div>
            </fieldset>
          </section>

          <section class="pulse__section pulse__section--consent">
            <fieldset class="pulse__fieldset" id="attention-fieldset">
              <legend>Attention &amp; consent</legend>
              <p class="muted">Select the matching statement to confirm you're still with us.</p>
              <div class="attention-options" id="attention-options"></div>
            </fieldset>
            <label class="consent">
              <input type="checkbox" id="consent-checkbox" name="consent" required />
              I confirm this summary can be shared with the CXI leadership team.
            </label>
          </section>

          <footer class="pulse__footer">
            <button type="submit" class="submit-btn" id="submit-btn" disabled>Submit pulse</button>
            <p class="muted" id="submit-hint">Complete the required fields to enable submit.</p>
          </footer>
        </form>
      </div>
    </div>

    <script type="module" src="./js/app.js"></script>
  </body>
</html>
